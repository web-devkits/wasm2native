# Embed compiled native object file in C/C++

From the previous documentation on how to [compile Wasm to native](./compile_wasm_app_to_native.md), we have seen how to compile the wasm app to a native object file and link it with the auxiliary library to the native binary, both `sandbox` mode and `no-sandbox` mode. In this section, we will explore the difference between `sandbox` and `no-sandbox` modes in more detail.

## Wasm app is compiled to native in sandbox mode

The sandbox mode is the default mode when compiling the wasm app to native. As its name suggests, it preserves the Wasm sandbox mechanism, and the Wasm address space and native address space are kept separate.

In the sandbox mode, the native binary object file will export the API defined in `w2n_export.h`, you can use them in the host native binary to interact with the wasm app, such as `wasm_instance_create`, `wasm_get_export_apis` can be used to lookup the wasm function and then call it. You can also get exceptions, the base address and size of linear memory, host-managed heap information, etc.

And the native binary object needs to be further linked with `libc-builtin.c` to provide C standard library APIs. After that, it can mainly used in two ways:

1. Link with source files like `wasm_application.c` and `main.c` then an **executable file** can be generated, and the `--invoke func` and `--repl` command line options are supported to call a function. If these two options are not used, the default is to execute the main function of the wasm app, if it exists.

2. If `wasm_application.c` and `main.c` are not linked, then normally a **static library** or a **dynamic library** is generated, and when using this library, normally in the other source code that the native object file linked with, export APIs defined in `w2n_export.h`.

## Wasm app is compiled to native in no-sandbox mode

In the no-sandbox mode, the Wasm sandbox is discarded, and the Wasm address space and native address space are the same. This allows sharing pointers (e.g., memory pointers, function pointers) between Wasm and native.

Normally, it will link with `libc64_nosandbox_wrapper.c`, and then generate a native binary similar to the one compiled directly by gcc. You can use the native binary generated by gcc the same way as here.
